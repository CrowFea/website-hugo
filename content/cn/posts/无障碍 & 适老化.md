---
title: iOS｜无障碍 & 适老化
date: 2021-09-23
categories: ['iOS']
draft: false
---

## 背景

[](https://www.miit.gov.cn/zwgk/zcwj/wjfb/txy/art/2021/art_b04e1baa455c448b80fb790d7c50bfd4.html)

[微信、支付宝等 43 个 APP 将进行适老化及无障碍改造，如何评价这一举动？具有什么样的社会意义?](https://www.zhihu.com/question/436424668)

👆此为背景，非常明确。GR需求永远是P00级别的需求。

改造实际上分为两个部分，1⃣️ 无障碍：指的是对于残障人士，特别是视力障碍人士的使用体验改造。具体的表现是，点击屏幕上的元素会发出声音提示；2⃣️ 适老化：指的是对于老年人的使用体验改造。目前的表现是：字体放大。简单粗暴。当然，真正的适老化改造应该从产品形态上做出调整，从设计上更方便老年人使用，而不是单纯的放大字体。

## 适老化

首先看一下适老化的部分。这部分相对简单，毕竟只需要把字体设置一下就可以。这里我们的诉求有两个：

- 可以区分是不是适老化模式
- 各业务尽可能方便的接入，并且侵入性较小

直接来看方案，将所有的判断 & 放大算法 & 放大倍数等属性都抽出放在一个manager中。接下来对UIFont做一个category，里面包含设置字体的防范。方法最好是包装成内部处理是否适老化的，而不用外部传入。因为适老化应该是全局打开的一个开关。外部直接调用设置字体的方法，这个方法内部会判决是不是需要进行相应的放大。

## 无障碍

### API

无障碍的部分相对麻烦。在iOS上，我们主要是使用系统提供的功能：「旁白」，以及相对应的API：`UIAccessibility`.

`UIAccessibility`实际上是`NSObject`的一个`category`，因此大部分系统的组件都是有相对应的属性。我们在下面列一下主要会用到的几个属性：

[Untitled](https://www.notion.so/c72b803eb3ec42a89905bcca6d09af74)

[掘金](https://juejin.cn/post/6844904007702577159)

[iOS无障碍适配总结 | 轻舟半尺](https://xcanoe.top/post/无障碍适配总结/)

详细的介绍可以看👆两篇文章。

### 手势

如果你是第一次打开iOS的「旁白」模式，一定会一脸懵逼。适应该模式下的操作需要一定的时间。我们大概描述一下基本的手势操作：

- 轻点一下：轻点的元素将被设为焦点，并朗读。在屏幕上的任何手势操作（除了轻点一下别的元素），都是对该焦点元素，或者以该焦点元素为基准的操作
- 轻点两下：对焦点元素进行操作，并将朗读`accessibilityHint`。
- 单指左右滑动：当前焦点元素的上一个（左滑）/下一个（右滑）被设为焦点，并朗读。
- 单指拖拽：随手指滑动选择焦点。
- 三指轻扫：滑动。
- 没有Home键的Home out：很精妙的操作。首先你需要从下往上，慢慢滑动。当你感觉到有一次震动，松开。此时就是Home out。若你继续往上滑，感觉到两次震动，松开，就是打开多任务视图。

### 元素顺序

前面我们提到了单指左右滑动，会自动选择上一个/下一个元素。这里就势必有一个顺序问题。

如果当前的页面没有显式的指定元素的顺序的时候，元素的顺序是由上到下，由左到右，由高到低。因此真正的顺序和用户看到的并不一样。

当然我们可以手动的设置顺序，对父View设置`accessibilityElements`。这是一个数组，数组中依次设置好元素的顺序即可。

 **⚠️坑** 

这里有个坑，如果某个元素的高度为0，那么手势滑动走到这个元素的下一个就会卡住。无法再滑动。这种情况下就需要把它hidden掉，或者设置他的`isAccessibilityElement`为NO。

### 聚合朗读

有时我们的一个元素内有多个小的元素。在朗读时希望聚合在一起朗读。可以把父View的朗读标签直接设置成所有子元素的标签即可。
